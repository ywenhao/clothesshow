var scrolling=!1,firstInit=!0,windowWidth=$(window).width(),s,el,prevIndex,scrollDir,menuTimer,idleTime=0,currentTarget,totalDistance=0,lastSeenAt={x:null,y:null},instantClick=!1,animating=!1;$(function(){$(window).scroll(function(){scrolling=!0,$("[data-details]").removeClass("active"),clearTimeout($.data(this,"scrollTimer")),$.data(this,"scrollTimer",setTimeout(function(){scrolling=!1},250))}),navigator.userAgent.match(/Trident\/7|Edge\/\d+\./)&&($("body").on("mousewheel",function(){event.preventDefault();var e=event.wheelDelta,t=window.pageYOffset;window.scrollTo(0,t-e)}),$("body").keydown(function(e){e.preventDefault();var t=window.pageYOffset;switch(e.which){case 38:window.scrollTo(0,t-120);break;case 40:window.scrollTo(0,t+120);break;default:return}})),hoverHandler.init()}),$(window).on("resize",function(){$(this).width();hoverHandler.init()});var mql=window.matchMedia("(orientation: portrait)"),menuHandler=function(){var e=$(".main__menu");return{init:function(){isMobile.any?($(".js-menu-trigger-mobile").on("click",menuHandler.show),$(".js-menu-trigger-desktop").on("click",menuHandler.show)):($(document).mousemove(menuHandler.showMain),$(".js-menu-trigger-desktop").hover(menuHandler.show,menuHandler.hide)),$("[data-link]").on("click",menuHandler.goTo)},goTo:function(e){isMobile.any?(firstInit=!0,$.fn.fullpage.silentMoveTo($(this).attr("data-link")),menuHandler.hide()):$("html,body").animate({scrollTop:$('.article__item[data-post-url="'+$(this).attr("data-link")+'"]').position().top},0,"easeInOutQuad"),e.preventDefault()},showMain:function(t){if(lastSeenAt.x&&(totalDistance+=Math.sqrt(Math.pow(lastSeenAt.y-t.clientY,2)+Math.pow(lastSeenAt.x-t.clientX,2))),lastSeenAt.x=t.clientX,lastSeenAt.y=t.clientY,totalDistance>20){if(currentTarget=t,e.hasClass("show"))return!1;e.addClass("show"),idleTime=0,menuTimer=setInterval(menuHandler.timer,1e3)}},timer:function(){return $(currentTarget.target).parents(".main__menu").length>0||$(currentTarget.target).hasClass(".main__menu")?!1:(idleTime++,void(idleTime>1&&(clearInterval(menuTimer),menuHandler.hideMain(),totalDistance=0)))},hideMain:function(){e.removeClass("show"),e.removeClass("active")},show:function(){e.toggleClass("active")},hide:function(){return!isMobile.any&&($(currentTarget.target).parents(".main__menu").length>0||$(currentTarget.target).hasClass(".main__menu"))?!1:void e.removeClass("active")}}}(),hoverHandler=function(){var e,t;return{init:function(){if(mql.matches){if(!firstInit)return!1;isMobile.any?hoverHandler.mobileHandler():hoverHandler.normalHandler()}else{if(!firstInit)return!1;isMobile.any?hoverHandler.mobileHandler():hoverHandler.normalHandler()}},setHistory:function(e,t){history.pushState(null,e,t),document.title="Bao Yao Fei | "+e,window.ga&&ga.create&&(ga("set","page",t),ga("send","pageview"))},mobileHandler:function(){$(".article__item").innerHeight($(window).height()),mql.addListener(function(){$(".article__item").innerHeight($(window).height())}),hoverHandler.unbind(),hoverHandler.bindPortrait(),$("html").addClass("mobile"),$(".section-wrapper").fullpage({direction:"vertical",verticalCentered:!1,css3:!0,sectionSelector:".article__item",navigation:!1,scrollingSpeed:500,easingcss3:"linear",scrollOverflow:!0,afterRender:function(){firstInit||menuHandler.init(),$.fn.fullpage.silentMoveTo(location.pathname);var e="/portfolio/"===location.pathname?"/":location.pathname;$('.article__item[data-post-url="'+e+'"]').prevAll().addClass("up-down")},afterLoad:function(e,t){return animating=!1,firstInit||hoverHandler.setHistory($(".article__item").eq(t-1).attr("data-post-title"),$(".article__item").eq(t-1).attr("data-post-url")),firstInit?($(".section-wrapper").addClass("no-transition"),$(".article__item").addClass("no-transition"),setTimeout(function(){$(".section-wrapper").removeClass("no-transition"),$(".article__item").removeClass("no-transition")},5),firstInit=!1,!1):void("down"===scrollDir?($(".article__item").eq(t-1).addClass("no-transition"),setTimeout(function(){$(".article__item").eq(t-1).removeClass("down-up")},5),setTimeout(function(){$(".article__item").eq(t-1).removeClass("no-transition")},10),$(".article__item").eq(prevIndex-1).addClass("no-transition"),setTimeout(function(){$(".article__item").eq(prevIndex-1).addClass("up-down").removeClass("down-down")},5),setTimeout(function(){$(".article__item").eq(prevIndex-1).removeClass("no-transition")},10)):"up"===scrollDir&&($(".article__item").eq(t-1).addClass("no-transition"),setTimeout(function(){$(".article__item").eq(t-1).removeClass("down-up")},5),setTimeout(function(){$(".article__item").eq(t-1).removeClass("no-transition")},10),$(".article__item").eq(prevIndex-1).addClass("no-transition"),setTimeout(function(){$(".article__item").eq(prevIndex-1).removeClass("up-up").removeClass("down-down").addClass("up-up")},5),setTimeout(function(){$(".article__item").eq(prevIndex-1).removeClass("no-transition")},10)))},afterResize:function(){},onLeave:function(e,t,n){return $("body").hasClass("modal--open")||animating===!0?!1:(animating=!0,menuHandler.hide(),"down"===n?(scrollDir=n,firstInit?($(".article__item").eq(t-1).removeClass("up-up").removeClass("up-down").addClass("active"),$(".article__item").eq(t-1).prevAll().addClass("up-down"),$(".section-wrapper").addClass("no-transition"),setTimeout(function(){$(".section-wrapper").removeClass("no-transition")},800),firstInit=!1):($(".article__item").eq(e-1).removeClass("down-up").addClass("down-down"),$(".article__item").eq(t-1).removeClass("down-down").removeClass("down-up").removeClass("up-down").removeClass("up-up"))):"up"===n&&(scrollDir=n,firstInit?($(".article__item").eq(t-1).removeClass("up-up").removeClass("up-down").addClass("active"),$(".section-wrapper").addClass("no-transition"),setTimeout(function(){$(".section-wrapper").removeClass("no-transition")},800),firstInit=!1):($(".article__item").eq(e-1).removeClass("up-down").addClass("up-up"),$(".article__item").eq(t-1).removeClass("up-up").removeClass("up-down").removeClass("down-down"))),void(prevIndex=e))}})},normalHandler:function(){$("html").removeClass("mobile"),hoverHandler.unbind(),hoverHandler.bindLandscape(),menuHandler.init(),$(".men .article__container, .women .article__container").attr("data-top","transform:translateZ(0) translateY(0%)").attr("data-top-bottom","transform:translateZ(0) translateY(100%)").attr("data-bottom-top","transform:translateZ(0) translateY(-100%)"),s=skrollr.init({forceHeight:!1}),firstInit=!1},click:function(n){return scrolling?!1:(e=$(this).attr("data-hitarea"),t=$(this).closest("[data-post-id]").attr("data-post-id"),$("[data-post-id] [data-details]").removeClass("active"),$("[data-post-id="+t+"] [data-details="+e+"]").addClass("active"),void n.preventDefault())},normal:function(){return scrolling?!1:void $("[data-post-id="+t+"] [data-details="+e+"]").removeClass("active")},bindPortrait:function(){$("[data-hitarea]").on("click",function(){$("body").addClass("modal--open"),e=$(this).attr("data-hitarea"),t=$(this).closest("[data-post-id]").attr("data-post-id"),el=$("[data-post-id="+t+"] [data-details="+e+"]"),$(".main__menu").fadeOut(300),el.css({display:"block"}),setTimeout(function(){el.addClass("active")},10)}),$(".js-modal--close").on("click",function(){el.removeClass("active"),setTimeout(function(){el.css({display:"none"}),$("body").removeClass("modal--open")},201),$(".main__menu").fadeIn(200)})},bindLandscape:function(){$("[data-hitarea]").on("click",hoverHandler.click);var e="/portfolio/"===location.pathname?"/":location.pathname;$("html,body").animate({scrollTop:$('[data-post-url="'+e+'"]').offset().top},200),$(window).on("scroll",function(){0===$("body").scrollTop()&&(firstInit||hoverHandler.setHistory($(".intro-slide").attr("data-post-title"),$(".intro-slide").attr("data-post-url")))});$(".article__item").waypoint({handler:function(){firstInit||hoverHandler.setHistory($(this.element).attr("data-post-title"),$(this.element).attr("data-post-url"))},offset:"10%"})},unbind:function(){$("[data-hitarea]").off()}}}(),aboutController=function(){return{init:function(){}}}();